<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Oracle on Effectiveさお</title>
    <link>https://h-sao.com/tags/oracle/</link>
    <description>Recent content in Oracle on Effectiveさお</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>ja-jp</language>
    <lastBuildDate>Sat, 19 Apr 2014 21:46:45 +0900</lastBuildDate>
    
	<atom:link href="https://h-sao.com/tags/oracle/index.xml" rel="self" type="application/rss+xml" />
    
    
    <item>
      <title>[PowerShell] 32bitと64bitの使い分け</title>
      <link>https://h-sao.com/blog/2014/04/19/about-powershell-x32-and-x64/</link>
      <pubDate>Sat, 19 Apr 2014 21:46:45 +0900</pubDate>
      
      <guid>https://h-sao.com/blog/2014/04/19/about-powershell-x32-and-x64/</guid>
      <description>PowerShellにはちゃんと 32bit版と 64bit版が備わっています
Windows2008 R2
Windows2012 R2
共に同じ場所にあります(~o~)
64bit版
C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
32bit版
C:\Windows\SysWOW64\WindowsPowerShell\v1.0\powershell.exe
デフォルトの64bitマシンであれば、コンソールで
&amp;gt; powershell  とすると、64bitモードが立ち上がります
これはどういうことかというと、64bitのアプリから使うライブラリなどは、64bitでないとダメってことです
何にはまったかというと、PowerShell から System.Data.OracleClient に接続するとき
たとえDBサーバが 64bit Oracle だったとしても
Oracle Client はデフォルトでは 32bit になっているようです
powershell から oracle に接続しようとしたときこんな感じになります
# アセンブリのロード [void][System.Reflection.Assembly]::LoadWithPartialName(&amp;quot;System.Data.OracleClient&amp;quot;) # 接続 $conn_str = &amp;quot;Data Source=saoDB;User ID=sao;Password=password;Integrated Security=false;&amp;quot; $ora_conn = New-Object System.Data.OracleClient.OracleConnection($conn_str) # インスタンス $ora_cmd = New-Object System.Data.OracleClient.OracleCommand $ora_cmd.Connection = $ora_conn # データベースに接続 $ora_conn.Open()  （参考）powerShellからOracleを使う（接続・切断）
http://harikofu.blog.fc2.com/blog-entry-114.html
このDB接続直後に、64bit のPowerShell だと
こんなエラーが出ます
&amp;quot;0&amp;quot; 個の引数を指定して &amp;quot;Open&amp;quot; を呼び出し中に例外が発生しました: &amp;quot;Oracle クライアント ライブラリを読み込もうとしましたが、BadImageFormatException が発行されました。この問題は、32 ビットの Oracle クライアント コンポーネントが インストールされている環境で 64 ビット モードを実行すると発生します。&amp;quot; 発生場所 行:1 文字:22 + $ora_conn.</description>
    </item>
    
    <item>
      <title>[Oracle]テーブル・カラム名が不明でもDBに入っている値を検索したい</title>
      <link>https://h-sao.com/blog/2014/04/10/mining-for-value-from-db/</link>
      <pubDate>Thu, 10 Apr 2014 18:00:15 +0900</pubDate>
      
      <guid>https://h-sao.com/blog/2014/04/10/mining-for-value-from-db/</guid>
      <description>見知らぬデータベースを渡され、中を解析したい時…
ありますよね？ありますよね！？
全テーブルの全列に入っている値を横断検索したいという要求、あるんじゃないでしょうか？
探したら同じことを考えている人が居ました
 全テーブルの全列の値の検索方法について - Oracle Community
https://community.oracle.com/thread/2334738?tstart=0  方法は2種類
一つは dmp 出力して、テキスト検索 をするというもの
だいぶ力技ですけど、確かに、確実に検索できますね…
もう一つの方法は、PL/SQL で全データを総検索 するというもの
この方法、
やってみると、良い感じに動きます
お勧めです
テーブル名やカラム名が判らなくても、動きますしね！
めっちゃ感激したので、この記事にも SQL を載せておきます
このサンプルでは、全ての値に 「あ」 が入っているデータを検索します
どのテーブルの、どのカラムに、何件入っているかが判ります
う、嬉しい～!!!
1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26  declare sSQL VARCHAR2(128); sDATA VARCHAR2(500); type cursor_type is ref cursor; cur_search cursor_type; vCount INTEGER; ERR_CODE NUMBER := 0; ERR_MSG VARCHAR(255); begin for vRec in (select COLUMN_NAME,TABLE_NAME from USER_TAB_COLS where DATA_TYPE like &amp;#39;%CHAR%&amp;#39;) loop begin open cur_search for &amp;#39;select count(*) as cnt from &amp;#39; || vRec.</description>
    </item>
    
    <item>
      <title>[Oracle] 直前のSQLを再実行する</title>
      <link>https://h-sao.com/blog/2014/01/18/rerun-last-sql/</link>
      <pubDate>Sat, 18 Jan 2014 00:53:07 +0900</pubDate>
      
      <guid>https://h-sao.com/blog/2014/01/18/rerun-last-sql/</guid>
      <description>OracleのコマンドラインでSQLを実行させるときのメモ
直前のSQLコマンドを実行は / (スラッシュ)
この場合、直前のバッファの内容は表示しません
1  SQL&amp;gt; /   直前のバッファの内容を表示して実行するのは run コマンド
1  SQL &amp;gt; run   直前のバッファの内容を修正するには edit コマンド
タイプミスなどを修正できます
ただし、環境変数 &amp;ldquo;_editor&amp;rdquo; にエディタの設定をしておく必要があります
1 2  SQL &amp;gt; define _editor=vi SQL &amp;gt; edit   （参考）
 OracleのSQL*Plusで直前に実行したSQLを再実行
http://margrave.seesaa.net/article/127477048.html
 SQL バッファの編集、エディタで編集する
http://www.shift-the-oracle.com/sqlplus/command/edit.html
 直前に実行したSQLをエディタで編集する
http://sakusakuit.blog.fc2.com/?m&amp;amp;no=15
  </description>
    </item>
    
  </channel>
</rss>